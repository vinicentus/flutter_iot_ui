# flutter_iot_ui
A user interface to fetch and show data generated by IoT devices, that are controlled indirectly through smart contracts. This project requires a deployed version of the smart contracts in the
[Smart Contract Backend](https://github.com/vinicentus/oracle-manager), and one or more IoT devices running [IoT-Microservice](https://github.com/vinicentus/IoT-Microservice/).  
The user inteface can be used to inspect and modify the most commonly used parameters of the smart contracts.

[geth-docker](https://github.com/vinicentus/geth-docker) can be used to start a simple ethtereum test network, on which the smart contracts can be deployed.

## Getting Started

This project can be run as a standalone flutter application. It is tested on Windows using desktop support for flutter, and on raspberry pi devices using [flutter-pi](https://github.com/ardera/flutter-pi). It is not tested on web or mobile devices, but could probably be modified to work on these target platforms.

This project can be run on a completely separate device from the device that is generating data, in which case the "show data from local database" switch in the settings page should be turned off.
This can also be run on the IoT device generating data, in our case a Raspberry Pi, to show data from the local database.

You can update paths in [paths.dart](lib/core/util/paths.dart) as needed.

### Prerequisites
A working [flutter](https://docs.flutter.dev/get-started/install) installation with desktop support enabled. See [Desktop support for Flutter](https://docs.flutter.dev/desktop).

### Installation steps

* _uplink_dart:_ follow the build steps of [uplink_dart](https://github.com/vinicentus/uplink_dart#instalation-steps) and place the resulting .so file in the path indicated by `libuplinkcDllPath` in [paths.dart](lib/core/util/paths.dart) (can be modified).

* _sqlite3:_
    * _linux:_ install "libsqlite3-dev", `sudo apt install libsqlite3-dev`
    * _windows:_ Go to [sqlite.org](https://www.sqlite.org/download.html), download the precompiled binaries, and put them in a directory indicated by `sqliteDllPath` in [paths.dart](lib/core/util/paths.dart) This variable can be modified to point to your preferred path.
    * See [sqlite3](https://pub.dev/packages/sqlite3#manually-providing-sqlite3-libraries) for more information

* update any other paths in [paths.dart](lib/core/util/paths.dart) to suit your needs and your machine.

* run this project, either in you IDE or from the terminal using `flutter run`, see the flutter docs if you want to build an executable

#### Running on IoT device (Raspberry Pi)
If you want to run this directly on the IoT device, and it is a raspberry pi running Raspberry Pi OS, then follow the installation steps from [flutter-pi](https://github.com/ardera/flutter-pi).

### Configuring contracts and devices

* Open the users page, create a user

* Open the tokens page, add tokens to your user

* Open the devices page

* Create a new device with the correct sensors, and select it

* copy over the generated `device_settings.yaml`, writing over the existing one in `IoT-Microservice/app/resources/`

* start the python service on the IoT device

* Toggle the device to be active

You are now free to view the data by selecting a data page from the menu.
